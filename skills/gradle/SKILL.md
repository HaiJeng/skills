---
name: gradle
description: Modern build automation tool for Java projects using Gradle. Use when working with Gradle projects (build.gradle, settings.gradle), managing dependencies, or running Gradle tasks.
triggers:
- gradle
- build.gradle
- settings.gradle
- gradlew
- "gradle build"
- "gradle task"
---

# Gradle Development Guide

## Gradle Project Structure

Standard Gradle project layout:

```
my-project/
├── build.gradle               # Build script (Groovy DSL)
├── build.gradle.kts           # Build script (Kotlin DSL)
├── settings.gradle            # Project settings
├── gradle.properties          # Configuration properties
├── gradlew                    # Gradle wrapper script (Unix)
├── gradlew.bat                # Gradle wrapper script (Windows)
├── src/
│   ├── main/
│   │   ├── java/              # Production Java source code
│   │   └── resources/         # Production resources
│   └── test/
│       ├── java/              # Test Java source code
│       └── resources/         # Test resources
└── build/                     # Build output (generated by Gradle)
```

## Essential Gradle Commands

### Build Commands

```bash
# Build the project
./gradlew build

# Clean build output
./gradlew clean

# Clean and build
./gradlew clean build

# Run tests
./gradlew test

# Run a specific test class
./gradlew test --tests MyTestClass

# Run a specific test method
./gradlew test --tests MyTestClass.testMethod

# Build without running tests
./gradlew build -x test

# Assemble JAR/WAR
./gradlew assemble

# Install to local repository
./gradlew install

# Generate idea project files
./gradlew idea

# Generate eclipse project files
./gradlew eclipse
```

### Dependency Management Commands

```bash
# List all dependencies
./gradlew dependencies

# List dependencies per configuration
./gradlew dependencies --configuration compileClasspath

# Show dependency tree
./gradlew dependencyInsight --dependency <dependency-name>

# Refresh dependencies (force update)
./gradlew build --refresh-dependencies

# Analyze dependencies (find unused)
./gradlew dependencyCheckAnalyze
```

### Project Information Commands

```bash
# List all available tasks
./gradlew tasks

# List all tasks including hidden ones
./gradlew tasks --all

# Show project report
./gradlew projects

# Show help for a specific task
./gradlew help --task build

# Display project properties
./gradlew properties
```

### Build Scanning and Analysis

```bash
# Generate build scan (requires build scan plugin)
./gradlew build --scan

# Run in dry-run mode (see what would execute)
./gradlew build --dry-run

# Print more information during build
./gradlew build --info

# Print debug information
./gradlew build --debug
```

## Understanding build.gradle

### Basic build.gradle (Groovy DSL)

```groovy
plugins {
    id 'java'
    id 'application'
}

group = 'com.example'
version = '1.0-SNAPSHOT'

java {
    sourceCompatibility = JavaVersion.VERSION_11
    targetCompatibility = JavaVersion.VERSION_11
}

repositories {
    mavenCentral()
}

dependencies {
    // Production dependencies
    implementation 'org.apache.commons:commons-lang3:3.12.0'
    
    // Testing dependencies
    testImplementation 'org.junit.jupiter:junit-jupiter:5.9.2'
    testImplementation 'org.mockito:mockito-core:5.1.1'
}

application {
    mainClass = 'com.example.Main'
}

test {
    useJUnitPlatform()
}

// Custom task
task customTask {
    doLast {
        println 'Executing custom task'
    }
}
```

### Basic build.gradle.kts (Kotlin DSL)

```kotlin
plugins {
    java
    application
}

group = "com.example"
version = "1.0-SNAPSHOT"

java {
    sourceCompatibility = JavaVersion.VERSION_11
    targetCompatibility = JavaVersion.VERSION_11
}

repositories {
    mavenCentral()
}

dependencies {
    implementation("org.apache.commons:commons-lang3:3.12.0")
    testImplementation("org.junit.jupiter:junit-jupiter:5.9.2")
    testImplementation("org.mockito:mockito-core:5.1.1")
}

application {
    mainClass.set("com.example.Main")
}

tasks.test {
    useJUnitPlatform()
}
```

## Dependency Configurations

### Java Plugin Configurations

- **implementation**: Dependencies for production code (not exposed to consumers)
- **api**: Dependencies exposed to consumers of this library (Java Library plugin)
- **compileOnly**: Dependencies needed for compilation but not runtime (e.g., annotations)
- **runtimeOnly**: Dependencies needed at runtime but not for compilation
- **testImplementation**: Dependencies for test compilation
- **testRuntimeOnly**: Dependencies for test runtime only
- **testCompileOnly**: Compile-only dependencies for tests

### Adding Dependencies

```groovy
// Single dependency
implementation 'org.apache.commons:commons-lang3:3.12.0'

// Exclude a transitive dependency
implementation ('org.springframework.boot:spring-boot-starter-web') {
    exclude group: 'org.springframework.boot', module: 'spring-boot-starter-tomcat'
}

// Force specific version of transitive dependency
configurations.all {
    resolutionStrategy {
        force 'org.slf4j:slf4j-api:1.7.36'
    }
}
```

## Multi-Project Builds

### settings.gradle

```groovy
rootProject.name = 'my-multi-project'

include ':app'
include ':library'
include ':utils'
```

### Build Structure

```
my-multi-project/
├── settings.gradle
├── build.gradle              // Root build file
├── app/
│   └── build.gradle
├── library/
│   └── build.gradle
└── utils/
    └── build.gradle
```

### Configuring Subprojects

```groovy
// Root build.gradle
subprojects {
    apply plugin: 'java'
    
    repositories {
        mavenCentral()
    }
    
    dependencies {
        testImplementation 'org.junit.jupiter:junit-jupiter:5.9.2'
    }
}
```

## Gradle Wrapper

The Gradle Wrapper allows builds to run without requiring Gradle to be installed on the system.

```bash
# Generate wrapper files
gradle wrapper --gradle-version 8.0

# Use specific distribution type
gradle wrapper --gradle-version 8.0 --distribution-type all

# Verify wrapper
./gradlew --version
```

## Best Practices

1. **Use Gradle Wrapper**: Always commit gradlew files to version control
2. **Dependency Versions**: Use gradle/libs.versions.toml for version catalogs (Gradle 7.0+)
3. **Build Cache**: Enable build cache for faster builds
4. **Configuration Cache**: Enable configuration cache (Gradle 6.6+)
5. **Parallel Execution**: Use `--parallel` for parallel project builds
6. **Incremental Builds**: Gradle automatically performs incremental builds
7. **Use Kotlin DSL**: Prefer Kotlin DSL for type safety and better IDE support
8. **Plugin Management**: Use `plugins {}` block instead of `apply plugin:`

### Version Catalog Example (gradle/libs.versions.toml)

```toml
[versions]
guava = "31.1"
junit = "5.9.2"

[libraries]
guava = { module = "com.google.guava:guava", version.ref = "guava" }
junit-jupiter = { module = "org.junit.jupiter:junit-jupiter", version.ref = "junit" }

[plugins]
java = { id = "java", version = "0.0.1" }
```

Usage in build.gradle.kts:
```kotlin
dependencies {
    implementation(libs.guava)
    testImplementation(libs.junit.jupiter)
}
```

## Common Issues and Solutions

### Issue: "Out of memory during build"
```bash
# Increase Gradle memory
./gradlew build -Dorg.gradle.jvmargs="-Xmx2048m -XX:MaxMetaspaceSize=512m"

# Or set in gradle.properties
org.gradle.jvmargs=-Xmx2048m -XX:MaxMetaspaceSize=512m
```

### Issue: Build is slow
```bash
# Enable parallel builds
./gradlew build --parallel

# Enable build cache
./gradlew build --build-cache

# Enable configuration cache
./gradlew build --configuration-cache

# Use --dry-run to analyze tasks
./gradlew build --dry-run
```

### Issue: Dependency conflicts
```bash
# View dependency insights
./gradlew dependencyInsight --dependency <conflicting-dependency>

# Exclude transitive dependencies
implementation('com.example:library:1.0') {
    exclude group: 'org.conflicting', module: 'conflicting-lib'
}
```

## Useful Gradle Plugins

### Applying Plugins

```groovy
// Java plugin
plugins {
    id 'java'
}

// Application plugin (for runnable applications)
plugins {
    id 'application'
}

// Java Library plugin (for libraries)
plugins {
    id 'java-library'
}

// Spring Boot plugin
plugins {
    id 'org.springframework.boot' version '3.0.0'
}
```

### Common Plugin Configurations

```groovy
// Checkstyle plugin
plugins {
    id 'checkstyle'
}

checkstyle {
    toolVersion = '10.3'
    configFile = file('config/checkstyle/checkstyle.xml')
}

// SpotBugs plugin
plugins {
    id 'com.github.spotbugs' version '5.0.13'
}

spotbugs {
    ignoreFailures = false
}

// JaCoCo (code coverage)
plugins {
    id 'jacoco'
}

test {
    finalizedBy jacocoTestReport
}

jacocoTestReport {
    dependsOn test
}
```

## Performance Optimization

Add to `gradle.properties`:

```properties
# Enable parallel builds
org.gradle.parallel=true

# Enable configuration cache
org.gradle.configuration-cache=true

# Enable build cache
org.gradle.caching=true

# Allocate more memory
org.gradle.jvmargs=-Xmx2048m -XX:MaxMetaspaceSize=512m

# Enable daemon
org.gradle.daemon=true
```

## Integration with IDEs

- **IntelliJ IDEA**: Native Gradle support, auto-import
- **Eclipse**: Run `./gradlew eclipse`
- **VS Code**: Use "Gradle for Java" extension
- **Android Studio**: Built-in Gradle support for Android projects
